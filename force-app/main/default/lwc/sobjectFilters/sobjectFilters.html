<template>
    <div class="slds-card slds-card_boundary">
        <lightning-card icon-name="utility:filterList" title={title}>
            <template for:each={searchFields} for:item="field" for:index="index">
                <div class="slds-col slds-size_1-of-1 slds-grid slds-wrap slds-p-horizontal_medium slds-p-bottom_small slds-border_bottom" key={field.guid}>
                    <div class="slds-col slds-size_11-of-12">
                        <lightning-combobox label="Select Field"
                                            placeholder="Select Field"
                                            options={selectOptions.fieldOptions}
                                            value={field.fieldName}
                                            onchange={handleFieldChange}
                                            disabled={isBusy}
                                            data-map="searchFields"
                                            data-path="[data-index].fieldName"
                                            data-index={index}
                        ></lightning-combobox>
                    </div>
                    <div class="slds-col_bump-left slds-p-top_large">
                        <lightning-button-icon title="Remove"
                                               icon-name="utility:delete"
                                               alternative-text="Remove"
                                               data-index={index}
                                               disabled={isBusy}
                                               onclick={handleRemoveSearchFieldClick}
                        ></lightning-button-icon>
                    </div>
                    <template lwc:if={field.fieldInfo}>
                        <div class="slds-col slds-size_3-of-12 slds-p-right_small">
                            <lightning-combobox label="Operator"
                                                onchange={handleFieldChange}
                                                options={field.operatorOptions}
                                                placeholder="Select an Option"
                                                value={field.operator}
                                                data-map="searchFields"
                                                disabled={isBusy}
                                                data-path="[data-index].operator"
                                                data-index={index}
                            ></lightning-combobox>
                        </div>
                        <div class="slds-col slds-size_8-of-12" key={field.guid}>
                            <c-vertic-input type={field.fieldInfo.type}
                                            label={field.fieldInfo.label}
                                            search-field={field.fieldInfo.searchField}
                                            s-object={field.fieldInfo.sObject}
                                            value={field.value}
                                            onchange={handleFieldChange}
                                            data-map="searchFields"
                                            disabled={isBusy}
                                            data-path="[data-index].value"
                                            data-index={index}
                                            options={field.fieldInfo.selectOptions}
                            ></c-vertic-input>
                        </div>
                    </template>
                </div>
            </template>
            <div class="slds-m-left_medium slds-m-top_small">
                <lightning-button label="Add Filter"
                                  if:false={isBusy}
                                  disabled={isBusy}
                                  onclick={handleAddSearchFieldClick}
                                  icon-name="utility:add"
                                  variant="neutral"
                ></lightning-button>
            </div>
        </lightning-card>
    </div>
</template>